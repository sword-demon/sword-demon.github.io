import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e as t}from"./app.50152c4e.js";const e={},p=t(`<h2 id="ipv4-tcp-\u5957\u63A5\u5B57\u5BA2\u6237\u7AEF" tabindex="-1"><a class="header-anchor" href="#ipv4-tcp-\u5957\u63A5\u5B57\u5BA2\u6237\u7AEF" aria-hidden="true">#</a> IPV4 TCP \u5957\u63A5\u5B57\u5BA2\u6237\u7AEF</h2><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$socket_fd</span> <span class="token operator">=</span> <span class="token function">socket_create</span><span class="token punctuation">(</span><span class="token constant">AF_INET</span><span class="token punctuation">,</span> <span class="token constant">SOCK_STREAM</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">socket_connect</span><span class="token punctuation">(</span><span class="token variable">$socket_fd</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;12345&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;connect ok\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;write len: &quot;</span> <span class="token operator">.</span> <span class="token function">socket_write</span><span class="token punctuation">(</span><span class="token variable">$socket_fd</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;recv from server: &quot;</span> <span class="token operator">.</span> <span class="token function">socket_read</span><span class="token punctuation">(</span><span class="token variable">$socket_fd</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token variable">$errno</span> <span class="token operator">=</span> <span class="token function">socket_last_error</span><span class="token punctuation">(</span><span class="token variable">$socket_fd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;connect fail: %d, %s\\n&quot;</span><span class="token punctuation">,</span> <span class="token variable">$errno</span><span class="token punctuation">,</span> <span class="token function">socket_strerror</span><span class="token punctuation">(</span><span class="token variable">$errno</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">socket_close</span><span class="token punctuation">(</span><span class="token variable">$socket_fd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5148\u8FD0\u884C\u524D\u9762\u5199\u597D\u7684\u670D\u52A1\u7AEF\uFF0C\u518D\u8FD0\u884C\u8FD9\u4E2A\u5BA2\u6237\u7AEF\u4F1A\u5F97\u5230\u5982\u4E0B\u7ED3\u679C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\u279C php tcp_client.php
connect ok
<span class="token function">write</span> len: 5recv from server: hi%
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u4F7F\u7528\u547D\u4EE4\uFF1A</p><p><code>strace -f -s 65500 php tcp_client.php</code>\u6765\u8DDF\u8E2A\u5176\u5185\u90E8\u4F7F\u7528\u7684\u662F\u4EC0\u4E48\u7CFB\u7EDF\u51FD\u6570\u6765\u5B8C\u6210\u7684\u3002</p><p>\u5927\u81F4\u5982\u4E0B\uFF1A</p><ul><li><code>socket</code>\u51FD\u6570\u521B\u5EFA\u5957\u63A5\u5B57</li><li><code>connect</code>\uFF1A\u8FDE\u63A5\u670D\u52A1\u7AEF</li><li><code>write</code>\uFF1A\u5199\u5185\u5BB9\uFF0C\u53D1\u9001\u5185\u5BB9</li><li><code>recvfrom</code>\uFF1A\u63A5\u6536\u503C</li></ul>`,8),o=[p];function c(i,l){return s(),a("div",null,o)}var k=n(e,[["render",c],["__file","ipv4-tcp-client.html.vue"]]);export{k as default};
